model_name is simplekt, dataset_name is assist2009
Read data from processed file: ../data/assist2009/test_sequences.csv_-1.pkl
file path: ../data/assist2009/test_sequences.csv, qlen: 1018, clen: 1018, rlen: 1018
Start preprocessing ../data/assist2009/test_window_sequences.csv fold: _-1...
interaction_num: 84344
file path: ../data/assist2009/test_window_sequences.csv, qlen: 39807, clen: 39807, rlen: 39807
Start preprocessing ../data/assist2009/test_question_sequences.csv fold: _-1...
interaction_num: 83564
file path: ../data/assist2009/test_question_sequences.csv, qlen: 1018, clen: 1018, rlen: 1018
Start preprocessing ../data/assist2009/test_question_window_sequences.csv fold: _-1...
interaction_num: 83568
file path: ../data/assist2009/test_question_window_sequences.csv, qlen: 39807, clen: 39807, rlen: 39807
has test_question_file!
Start predicting model: simplekt, embtype: qid, save_dir: saved_model/assist2009_simplekt_qid_saved_model_42_0_0.1_256_256_2_4_0.5_0.5_0.5_50_256_256_4_2_0.0001_1_1_2f5e7e78-d055-453b-b4a3-e51bd6ce3fae, dataset_name: assist2009
model_config: {'dropout': 0.1, 'final_fc_dim': 256, 'final_fc_dim2': 256, 'num_layers': 2, 'nheads': 4, 'loss1': 0.5, 'loss2': 0.5, 'loss3': 0.5, 'start': 50, 'd_model': 256, 'd_ff': 256, 'num_attn_heads': 4, 'n_blocks': 2}
data_config: {'dpath': '../data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'dataset_name': 'assist2009'}
model_name: simplekt, emb_type: qid
ts.shape: (83322,), ps.shape: (83322,)
testauc: 0.9005410483233891, testacc: 0.8309930150500469
ts.shape: (83568,), ps.shape: (83568,)
testauc: 0.9005410483233891, testacc: 0.8309930150500469, window_testauc: 0.8991940192649417, window_testacc: 0.8296357457399962
/home/zhjy/lizz/anaconda3/envs/pykt/lib/python3.11/site-packages/pykt/models/evaluate_model.py:259: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:230.)
  curhs = [torch.tensor(curh).float().to(device) for curh in curhs]
Traceback (most recent call last):
  File "/home/zhjy/lizz/Exp_DataSavePath/pykt/pykt-toolkit-main/examples/wandb_predict.py", line 138, in <module>
    main(params)
  File "/home/zhjy/lizz/Exp_DataSavePath/pykt/pykt-toolkit-main/examples/wandb_predict.py", line 110, in main
    qw_testaucs, qw_testaccs = evaluate_question(model, test_question_window_loader, model_name, fusion_type, save_test_question_window_path)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhjy/lizz/anaconda3/envs/pykt/lib/python3.11/site-packages/pykt/models/evaluate_model.py", line 519, in evaluate_question
    dcur, dhistory = group_fusion(dmerge, model, model_name, fusion_type, fout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhjy/lizz/anaconda3/envs/pykt/lib/python3.11/site-packages/pykt/models/evaluate_model.py", line 288, in group_fusion
    df["hidden"] = [np.array(a) for a in hs[0][bz].cpu().tolist()]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhjy/lizz/anaconda3/envs/pykt/lib/python3.11/site-packages/pykt/models/evaluate_model.py", line 288, in <listcomp>
    df["hidden"] = [np.array(a) for a in hs[0][bz].cpu().tolist()]
                    ^^^^^^^^^^^
KeyboardInterrupt